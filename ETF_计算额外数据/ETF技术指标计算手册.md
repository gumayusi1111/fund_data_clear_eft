# ETF技术指标计算完整手册

## 📊 项目概览

基于ETF的OHLCV数据（开盘、最高、最低、收盘、成交量），本项目可计算**13大类**共**130+个**技术指标，覆盖投资分析的各个维度。

## 🗃️ 数据字段说明

### 原始数据字段
- **代码**: ETF代码标识
- **日期**: 交易日期
- **开盘价**: 当日开盘价格
- **最高价**: 当日最高价格  
- **最低价**: 当日最低价格
- **收盘价**: 当日收盘价格
- **上日收盘**: 前一交易日收盘价
- **涨跌**: 当日涨跌金额
- **涨幅%**: 当日涨跌幅百分比
- **成交量(手数)**: 当日成交量
- **成交额(千元)**: 当日成交金额

### 衍生数据字段
- **典型价格**: (最高+最低+收盘)/3
- **日收益率**: (收盘价-前收盘价)/前收盘价
- **真实波幅**: max(最高-最低, |最高-前收盘|, |最低-前收盘|)

## 🎯 13大类技术指标体系

### 📈 1. 趋势类指标
**核心作用**: 识别价格趋势方向和强度
- **移动平均线**: SMA5, SMA10, SMA20, SMA60, SMA120, SMA250
- **指数移动平均**: EMA9, EMA12, EMA26, EMA50
- **加权移动平均**: WMA5, WMA10, WMA20
- **MACD指标组合**: DIF, DEA, MACD柱, 信号线交叉

### 📊 2. 波动性指标  
**核心作用**: 衡量价格波动程度和风险
- **布林带**: 上轨、中轨、下轨、带宽、位置百分比
- **真实波幅ATR**: ATR14, ATR20, 波动率百分比
- **历史波动率**: 20日、60日、250日波动率

### 💪 3. 相对强弱指标
**核心作用**: 判断超买超卖状态
- **RSI**: RSI6, RSI14, RSI28
- **威廉指标**: WR9, WR14, WR28
- **随机指标**: KDJ中的K值、D值

### 📦 4. 成交量指标
**核心作用**: 分析成交量与价格的配合关系
- **成交量均线**: 5日、10日、20日成交量均线
- **OBV指标**: 累积成交量平衡
- **量比**: 当日成交量/历史平均成交量
- **价量配合度**: 价涨量增的配合程度

### ⚡ 5. 动量指标
**核心作用**: 衡量价格变化的速度和力度
- **KDJ指标**: K值、D值、J值
- **CCI指标**: 商品通道指数
- **动量振荡器**: 价格动量、加速度

### 🎯 6. 支撑阻力指标
**核心作用**: 识别重要的价格支撑和阻力位
- **枢轴点**: 日枢轴点、周枢轴点
- **价格通道**: 上通道、下通道、中轴
- **关键价位**: 前高、前低、整数关口

### 🏗️ 7. 市场结构指标
**核心作用**: 分析价格形态和市场结构
- **缺口分析**: 向上缺口、向下缺口、缺口回补
- **K线形态识别**: 十字星、锤头、吞没形态
- **价格形态**: 头肩顶、双底、三角形

### 📐 8. 统计类指标
**核心作用**: 基于统计学的价格分析
- **收益率序列**: 日收益率、周收益率、月收益率
- **波动率统计**: 标准差、方差、偏度、峰度
- **统计描述**: 最大值、最小值、分位数

### 🔄 9. 复权相关指标
**核心作用**: 分析不同复权方式的差异
- **复权价格对比**: 前复权vs后复权vs除权
- **复权影响分析**: 股息率影响、拆分影响

### 💧 10. 流动性指标
**核心作用**: 衡量市场流动性和交易活跃度
- **可计算指标**: 成交额/流通市值比例
- **换手率估算**: 基于成交量的换手率
- **流动性评分**: 综合流动性指标

### 🛡️ 11. 风险度量指标 ⭐ 新增核心
**核心作用**: 投资风险的全面量化评估
- **VaR风险价值**: VaR_90, VaR_95, VaR_99
- **最大回撤**: 历史最大回撤、回撤持续期、恢复时间
- **夏普比率**: 风险调整后收益、索提诺比率、卡尔马比率
- **波动率指标**: 下行波动率、上行波动率、波动率偏度
- **极值风险**: CVaR、尾部风险、极端损失频率

### 💰 12. 资金流量指标 ⭐ 新增高价值
**核心作用**: 深度洞察资金流向和主力行为
- **MFI资金流量指标**: 成交量加权的RSI
- **A/D累积派发线**: 长期资金流向趋势
- **CMF蔡金货币流量**: 资金流量强度
- **EMV简易波动指标**: 价格推动的轻松程度
- **资金流量比率**: 正负资金流量对比
- **净资金流量**: 资金净流入流出

### ⏰ 13. 时间序列分析指标 ⭐ 新增前沿
**核心作用**: 基于时间维度的深度分析
- **季节性分析**: 月度效应、星期效应、节假日效应
- **周期性检测**: 傅里叶分析、自相关分析、周期强度
- **异常检测**: Z-Score异常、IQR异常、极值识别
- **趋势分解**: HP滤波、线性趋势、趋势变化点

## 🚀 计算能力评估

### 📊 数据覆盖率
- **完全可计算**: 约95%的指标
- **需要额外数据**: 约5%（主要是流通股本等）
- **计算复杂度**: 低到中等，适合实时计算

### ⚡ 实用性分级

#### 🔥 极高实用性 (第一优先级)
1. **移动平均线系统** - 趋势识别基础
2. **MACD指标组合** - 趋势转折信号
3. **RSI相对强弱** - 超买超卖判断
4. **最大回撤** - 风险控制核心
5. **MFI资金流量** - 资金动向分析

#### ⭐ 高实用性 (第二优先级)
6. **布林带** - 波动性分析
7. **KDJ指标** - 动量分析
8. **VaR风险价值** - 风险量化
9. **季节性分析** - 择时参考
10. **成交量分析** - 量价配合

#### 📈 中等实用性 (第三优先级)
11. **威廉指标** - 辅助超买超卖
12. **CCI指标** - 趋势强度
13. **A/D线** - 长期资金趋势
14. **异常检测** - 特殊事件识别
15. **其他统计指标** - 深度分析

## 💼 应用场景

### 🎯 投资决策支持
- **风险评估**: 使用VaR、最大回撤等指标
- **趋势判断**: 使用移动平均线、MACD等
- **择时分析**: 使用季节性、超买超卖指标
- **资金分析**: 使用MFI、A/D线等资金指标

### 📊 量化交易策略
- **趋势跟踪**: 基于移动平均线系统
- **均值回归**: 基于布林带、RSI等
- **动量策略**: 基于KDJ、CCI等
- **套利策略**: 基于价格形态、异常检测

### 🔬 风险管理
- **仓位控制**: 基于VaR、波动率
- **止损设置**: 基于最大回撤、ATR
- **风险监控**: 基于各类风险指标
- **压力测试**: 基于极值分析

### 📈 投资研究
- **市场分析**: 全方位技术指标分析
- **策略回测**: 基于历史指标数据
- **因子研究**: 指标因子的有效性分析
- **学术研究**: 标准化的计算方法

## 🔧 技术实现特点

### ✅ 优势特点
- **数据兼容性强**: 基于标准OHLCV数据
- **计算效率高**: 优化的算法实现
- **模块化设计**: 高内聚低耦合
- **实战导向**: 每个指标都有应用策略
- **文档完整**: 详细的计算方法和使用说明

### 🎯 使用建议
- **分层使用**: 先使用核心指标，再使用辅助指标
- **组合验证**: 多个指标相互验证，提高可靠性
- **参数调优**: 根据不同市场环境调整参数
- **风险控制**: 始终将风险管理放在首位

## 📋 总结

这套ETF技术指标计算系统涵盖了**13大类130+个指标**，基于现有的OHLCV数据就能计算95%以上的指标。特别是新增的**风险度量指标、资金流量指标、时间序列分析指标**三大类，填补了原有指标体系的重要空白，使整个技术分析框架更加完整和实用。

无论是个人投资者的投资决策，还是机构的量化交易策略，都能从这套指标体系中找到有价值的分析工具。通过合理运用这些指标，可以显著提升投资分析的科学性和有效性。

## 现有数据字段
基于当前ETF数据包含的字段：
- **代码**: ETF代码
- **日期**: 交易日期  
- **开盘价**: 当日开盘价格
- **最高价**: 当日最高价格
- **最低价**: 当日最低价格
- **收盘价**: 当日收盘价格
- **上日收盘**: 前一交易日收盘价
- **涨跌**: 当日涨跌金额
- **涨幅%**: 当日涨跌幅百分比
- **成交量(手数)**: 当日成交量
- **成交额(千元)**: 当日成交金额

---

## 可计算的技术指标清单

### 1. 趋势类指标

#### 1.1 移动平均线 (Moving Average)
- **SMA_5**: 5日简单移动平均线
- **SMA_10**: 10日简单移动平均线
- **SMA_20**: 20日简单移动平均线
- **SMA_60**: 60日简单移动平均线
- **SMA_120**: 120日简单移动平均线
- **SMA_250**: 250日简单移动平均线

#### 1.2 指数移动平均线 (Exponential Moving Average)
- **EMA_12**: 12日指数移动平均线
- **EMA_26**: 26日指数移动平均线
- **EMA_9**: 9日指数移动平均线

#### 1.3 加权移动平均线 (Weighted Moving Average)
- **WMA_5**: 5日加权移动平均线
- **WMA_10**: 10日加权移动平均线
- **WMA_20**: 20日加权移动平均线

#### 1.4 MACD指标组合
- **DIF**: 差离值 (EMA_12 - EMA_26)
- **DEA**: 信号线 (DIF的9日EMA)
- **MACD**: MACD柱 (DIF - DEA) × 2
- **MACD_Signal**: MACD信号 (金叉/死叉)

### 2. 波动性指标

#### 2.1 布林带 (Bollinger Bands)
- **BB_Middle**: 中轨 (20日SMA)
- **BB_Upper**: 上轨 (中轨 + 2×标准差)
- **BB_Lower**: 下轨 (中轨 - 2×标准差)
- **BB_Width**: 带宽 ((上轨-下轨)/中轨)
- **BB_Position**: 价格位置 ((收盘价-下轨)/(上轨-下轨))

#### 2.2 真实波幅 (Average True Range)
- **TR**: 真实波幅 = MAX(高-低, |高-昨收|, |低-昨收|)
- **ATR_14**: 14日平均真实波幅
- **ATR_21**: 21日平均真实波幅

#### 2.3 波动率指标
- **Volatility_20**: 20日历史波动率
- **Price_Range**: 当日振幅 ((最高价-最低价)/昨收盘×100%)

### 3. 相对强弱指标

#### 3.1 RSI (Relative Strength Index)
- **RSI_6**: 6日相对强弱指数
- **RSI_12**: 12日相对强弱指数
- **RSI_14**: 14日相对强弱指数
- **RSI_24**: 24日相对强弱指数

#### 3.2 威廉指标 (Williams %R)
- **WR_14**: 14日威廉指标
- **WR_21**: 21日威廉指标
- **计算公式**: (最高价-收盘价)/(最高价-最低价) × 100

### 4. 成交量指标

#### 4.1 成交量移动平均线
- **Volume_MA_5**: 5日成交量均线
- **Volume_MA_10**: 10日成交量均线
- **Volume_MA_20**: 20日成交量均线
- **Volume_MA_60**: 60日成交量均线

#### 4.2 量价指标
- **OBV**: 能量潮指标
- **Volume_Ratio**: 量比 (当日成交量/近期平均成交量)
- **Turnover_Rate_Base**: 换手率基础数据 (需要流通股本)
- **Amount_MA_5**: 5日成交额均线
- **Amount_MA_10**: 10日成交额均线

#### 4.3 价量配合度
- **Price_Volume_Correlation**: 价量相关性
- **Volume_Price_Trend**: 量价趋势指标

### 5. 动量指标

#### 5.1 KDJ指标
- **K_Value**: K值
- **D_Value**: D值  
- **J_Value**: J值 (3×K - 2×D)
- **KDJ_Signal**: KDJ信号

#### 5.2 CCI指标 (Commodity Channel Index)
- **CCI_14**: 14日顺势指标
- **CCI_20**: 20日顺势指标
- **Typical_Price**: 典型价格 ((最高价+最低价+收盘价)/3)

#### 5.3 动量振荡器
- **Momentum_10**: 10日动量
- **ROC_12**: 12日变动率

### 6. 支撑阻力指标

#### 6.1 枢轴点 (Pivot Point)
- **Pivot_Point**: 枢轴点 ((最高价+最低价+收盘价)/3)
- **Support_1**: 第一支撑位 (2×PP - 最高价)
- **Support_2**: 第二支撑位 (PP - (最高价-最低价))
- **Resistance_1**: 第一阻力位 (2×PP - 最低价)
- **Resistance_2**: 第二阻力位 (PP + (最高价-最低价))

#### 6.2 价格通道
- **Donchian_Upper**: 唐奇安上轨 (N日最高价)
- **Donchian_Lower**: 唐奇安下轨 (N日最低价)

### 7. 市场结构指标

#### 7.1 缺口分析
- **Gap_Up**: 向上缺口 (当日最低价 > 昨日最高价)
- **Gap_Down**: 向下缺口 (当日最高价 < 昨日最低价)
- **Gap_Size**: 缺口大小
- **Gap_Fill**: 缺口回补状态

#### 7.2 K线形态识别
- **Doji**: 十字星形态
- **Hammer**: 锤子线形态
- **Hanging_Man**: 上吊线形态
- **Engulfing_Bullish**: 看涨吞没形态
- **Engulfing_Bearish**: 看跌吞没形态
- **Inside_Bar**: 内包线形态
- **Outside_Bar**: 外包线形态

#### 7.3 价格形态
- **Higher_High**: 更高高点
- **Higher_Low**: 更高低点
- **Lower_High**: 更低高点
- **Lower_Low**: 更低低点

### 8. 统计类指标

#### 8.1 收益率序列
- **Daily_Return**: 日收益率 ((今收盘-昨收盘)/昨收盘)
- **Cumulative_Return**: 累计收益率
- **Weekly_Return**: 周收益率
- **Monthly_Return**: 月收益率
- **Annualized_Return**: 年化收益率

#### 8.2 波动率统计
- **Volatility_Daily**: 日波动率
- **Volatility_Weekly**: 周波动率
- **Volatility_Monthly**: 月波动率
- **Sharpe_Ratio_Base**: 夏普比率基础数据

#### 8.3 统计描述
- **Max_Price_20**: 20日最高价
- **Min_Price_20**: 20日最低价
- **Price_Percentile**: 价格分位数
- **Average_Amplitude**: 平均振幅

### 9. 复权相关指标

#### 9.1 复权价格对比
- **Forward_Backward_Diff**: 前复权与后复权价差
- **Adjusted_Raw_Ratio**: 复权价格与原始价格比率
- **Adjustment_Factor_Change**: 复权因子变化率

#### 9.2 复权分析
- **Dividend_Impact**: 分红影响分析
- **Split_Impact**: 拆股影响分析

### 10. 流动性指标 (部分可计算)

#### 10.1 可计算的流动性指标
- **Turnover_Velocity**: 成交活跃度 (成交额/平均成交额)
- **Volume_Weighted_Price**: 成交量加权平均价格 (VWAP)
- **Time_Weighted_Volume**: 时间加权成交量

#### 10.2 需要额外数据的指标
- **Turnover_Rate**: 换手率 (需要流通股本)
- **Market_Cap_Ratio**: 市值比率 (需要总市值)

---

## 计算优先级建议

### 🔥 第一优先级 (核心技术指标)
1. 移动平均线 (MA5, MA10, MA20, MA60)
2. MACD指标组合
3. RSI指标 (RSI14)
4. 布林带
5. 成交量均线

### ⭐ 第二优先级 (技术分析增强)
1. KDJ指标
2. ATR波动率
3. 威廉指标 (%R)
4. OBV能量潮
5. 收益率计算
6. 枢轴点支撑阻力

### 📊 第三优先级 (高级分析)
1. CCI指标
2. K线形态识别
3. 缺口分析
4. 波动率统计
5. 复权对比分析

---

## 使用示例

```python
# 获取ETF所有技术指标
analyzer = ETFTechnicalAnalyzer('159001')
indicators = analyzer.get_all_indicators()

# 访问具体指标
ma20 = indicators['趋势指标']['SMA_20']
rsi14 = indicators['强弱指标']['RSI_14']
bb_upper = indicators['波动性指标']['BB_Upper']
```

---

## 备注说明

1. **数据依赖**: 所有指标基于现有的OHLCV数据计算
2. **计算周期**: 建议保留至少250个交易日的数据以支持长周期指标
3. **实时更新**: 可以结合日更/周更系统自动计算新指标
4. **扩展性**: 框架支持添加新的自定义指标
5. **复权选择**: 建议使用前复权数据进行技术分析 