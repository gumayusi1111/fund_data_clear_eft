# ETFæ•°æ®è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿ

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå…¨è‡ªåŠ¨çš„ETFæ•°æ®æ›´æ–°ç³»ç»Ÿï¼Œå¯ä»¥æ¯æ—¥è‡ªåŠ¨ä»ç™¾åº¦ç½‘ç›˜ä¸‹è½½æœ€æ–°çš„ETFæ•°æ®ï¼Œè§£å‹å¹¶åˆå¹¶åˆ°æœ¬åœ°æ•°æ®åº“ä¸­ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **è‡ªåŠ¨ä¸‹è½½**ï¼šæ¯æ—¥ä»ç™¾åº¦ç½‘ç›˜ä¸‹è½½å½“å‰æœˆä»½çš„ETFæ•°æ®
- âœ… **æ™ºèƒ½æ£€æµ‹**ï¼šé€šè¿‡æ–‡ä»¶å“ˆå¸Œå€¼æ£€æµ‹æ•°æ®æ˜¯å¦æœ‰æ›´æ–°
- âœ… **å¢é‡åˆå¹¶**ï¼šåªæ›´æ–°æœ‰å˜åŒ–çš„æ•°æ®ï¼Œä¿æŒå†å²æ•°æ®å®Œæ•´
- âœ… **å®šæ—¶æ‰§è¡Œ**ï¼šæ”¯æŒå®šæ—¶ä»»åŠ¡ï¼Œæ— éœ€äººå·¥å¹²é¢„
- âœ… **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… **é€šçŸ¥ç³»ç»Ÿ**ï¼šå¯é€‰çš„é’‰é’‰/ä¼ä¸šå¾®ä¿¡é€šçŸ¥

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…å’Œé…ç½®

```bash
# è¿è¡Œå®‰è£…é…ç½®å‘å¯¼
python setup_auto_updater.py
```

å®‰è£…å‘å¯¼ä¼šè‡ªåŠ¨ï¼š
- å®‰è£…å¿…è¦çš„Pythonä¾èµ–åŒ…
- æ£€æŸ¥å¹¶æç¤ºå®‰è£…unarè§£å‹å·¥å…·
- é…ç½®ç™¾åº¦ç½‘ç›˜æˆæƒ
- åˆ›å»ºå¯åŠ¨è„šæœ¬
- å¯é€‰è®¾ç½®ç³»ç»ŸæœåŠ¡

### 2. ç™¾åº¦ç½‘ç›˜æˆæƒ

ç¬¬ä¸€æ¬¡ä½¿ç”¨éœ€è¦æˆæƒbypyè®¿é—®ä½ çš„ç™¾åº¦ç½‘ç›˜ï¼š

```bash
bypy info
```

æŒ‰ç…§æç¤ºå®Œæˆæˆæƒï¼ˆéœ€è¦ç™¾åº¦è´¦å·ç™»å½•ï¼‰ã€‚

### 3. è¿è¡Œæ›´æ–°

```bash
# æ‰‹åŠ¨è¿è¡Œä¸€æ¬¡æ›´æ–°
python etf_auto_updater.py once

# å¯åŠ¨å®šæ—¶æ›´æ–°æœåŠ¡
python etf_auto_updater.py schedule
```

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### å¿…éœ€ä¾èµ–
- Python 3.7+
- pandas (æ•°æ®å¤„ç†)
- requests (ç½‘ç»œè¯·æ±‚)
- schedule (å®šæ—¶ä»»åŠ¡)
- bypy (ç™¾åº¦ç½‘ç›˜å‘½ä»¤è¡Œå·¥å…·)
- unar (è§£å‹RARæ–‡ä»¶)

### æ”¯æŒå¹³å°
- âœ… macOS (æ¨èä½¿ç”¨Homebrewå®‰è£…unar)
- âœ… Linux (Ubuntu/CentOSç­‰ï¼Œä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…unar)
- âš ï¸ Windows (éœ€è¦æ‰‹åŠ¨å®‰è£…unar)

## âš™ï¸ é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶ï¼š`config.json`

```json
{
    "baidu_netdisk": {
        "share_url": "https://pan.baidu.com/s/1aZlvjI8dh3Cqs3nyMuYxlA",
        "password": "3gln",
        "download_method": "bypy"
    },
    "update_schedule": {
        "time": "09:00",        // æ›´æ–°æ—¶é—´
        "enabled": true         // æ˜¯å¦å¯ç”¨å®šæ—¶æ›´æ–°
    },
    "notification": {
        "enabled": false,       // æ˜¯å¦å¯ç”¨é€šçŸ¥
        "webhook_url": ""       // é’‰é’‰/ä¼ä¸šå¾®ä¿¡Webhook URL
    },
    "base_dir": ".",           // å·¥ä½œç›®å½•
    "log_level": "INFO"        // æ—¥å¿—çº§åˆ«
}
```

## ğŸ”„ å·¥ä½œæµç¨‹

```
1. æ£€æŸ¥å½“å‰æœˆä»½ â†’ "2024å¹´06æœˆ"
   â†“
2. æ„é€ æ–‡ä»¶å â†’ ["0_ETFæ—¥K(å‰å¤æƒ)_2024å¹´06æœˆ.rar", ...]
   â†“
3. ä¸‹è½½æ–‡ä»¶ â†’ temp/ç›®å½•
   â†“
4. æ£€æŸ¥æ–‡ä»¶å“ˆå¸Œ â†’ æ˜¯å¦æœ‰å˜åŒ–ï¼Ÿ
   â†“
5. è§£å‹RARæ–‡ä»¶ â†’ temp/extracted/
   â†“
6. åˆå¹¶æ•°æ® â†’ ETF/merged_data/
   â†“
7. æ¸…ç†ä¸´æ—¶æ–‡ä»¶ â†’ å®Œæˆ
```

## ğŸ“ ç›®å½•ç»“æ„

```
data_clear/
â”œâ”€â”€ ETF/
â”‚   â””â”€â”€ merged_data/
â”‚       â”œâ”€â”€ å‰å¤æƒ/     (1185+ CSVæ–‡ä»¶)
â”‚       â”œâ”€â”€ åå¤æƒ/     (1185+ CSVæ–‡ä»¶)
â”‚       â””â”€â”€ é™¤æƒ/       (1185+ CSVæ–‡ä»¶)
â”œâ”€â”€ temp/               (ä¸´æ—¶æ–‡ä»¶ï¼Œè‡ªåŠ¨æ¸…ç†)
â”œâ”€â”€ etf_auto_updater.py (ä¸»ç¨‹åº)
â”œâ”€â”€ setup_auto_updater.py (å®‰è£…å‘å¯¼)
â”œâ”€â”€ config.json         (é…ç½®æ–‡ä»¶)
â”œâ”€â”€ file_hashes.json    (æ–‡ä»¶å“ˆå¸Œè®°å½•)
â”œâ”€â”€ etf_updater.log     (æ—¥å¿—æ–‡ä»¶)
â””â”€â”€ start_etf_updater.sh (å¯åŠ¨è„šæœ¬)
```

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### ä½œä¸ºç³»ç»ŸæœåŠ¡è¿è¡Œ

#### macOS (launchd)
```bash
# å®‰è£…æœåŠ¡
launchctl load ~/Library/LaunchAgents/com.etf.autoupdater.plist
launchctl start com.etf.autoupdater

# åœæ­¢æœåŠ¡
launchctl stop com.etf.autoupdater
launchctl unload ~/Library/LaunchAgents/com.etf.autoupdater.plist
```

#### Linux (systemd)
```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo cp etf-updater.service /etc/systemd/system/
sudo systemctl enable etf-updater.service
sudo systemctl start etf-updater.service

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status etf-updater.service
```

### é€šçŸ¥é…ç½®

æ”¯æŒé’‰é’‰ç¾¤æœºå™¨äººé€šçŸ¥ï¼š

1. åœ¨é’‰é’‰ç¾¤ä¸­æ·»åŠ æœºå™¨äºº
2. è·å–Webhook URL
3. æ›´æ–°config.jsonä¸­çš„notificationé…ç½®

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **bypyæˆæƒå¤±è´¥**
   ```bash
   # é‡æ–°æˆæƒ
   bypy info
   ```

2. **unaræœªå®‰è£…**
   ```bash
   # macOS
   brew install unar
   
   # Ubuntu/Debian
   sudo apt-get install unar
   
   # CentOS/RHEL
   sudo yum install unar
   ```

3. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x start_etf_updater.sh
   ```

4. **Pythonä¾èµ–é—®é¢˜**
   ```bash
   # é‡æ–°å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   ```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f etf_updater.log

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯
grep ERROR etf_updater.log
```

## ğŸ”§ è‡ªå®šä¹‰å¼€å‘

ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ï¼š

```python
# è‡ªå®šä¹‰é€šçŸ¥æ–¹å¼
def custom_notification(message):
    # å®ç°ä½ çš„é€šçŸ¥é€»è¾‘
    pass

# è‡ªå®šä¹‰æ•°æ®å¤„ç†
def custom_data_processor(data):
    # å®ç°ä½ çš„æ•°æ®å¤„ç†é€»è¾‘
    return processed_data
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨æ–‡ä»¶å“ˆå¸Œå€¼é¿å…é‡å¤ä¸‹è½½
- å¢é‡æ•°æ®åˆå¹¶ï¼Œåªæ›´æ–°å˜åŒ–çš„æ–‡ä»¶
- è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´
- å¤šçº¿ç¨‹ä¸‹è½½ï¼ˆå¯é€‰æ‰©å±•ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œç¯å¢ƒ**ï¼šç¡®ä¿ç½‘ç»œç¨³å®šï¼Œç™¾åº¦ç½‘ç›˜è®¿é—®æ­£å¸¸
2. **ç£ç›˜ç©ºé—´**ï¼šé¢„ç•™è¶³å¤Ÿç©ºé—´å­˜å‚¨æ•°æ®ï¼ˆå»ºè®®2GB+ï¼‰
3. **ç™¾åº¦ç½‘ç›˜é™åˆ¶**ï¼šæ³¨æ„ä¸‹è½½é¢‘ç‡ï¼Œé¿å…è§¦å‘é™åˆ¶
4. **æ•°æ®å¤‡ä»½**ï¼šå»ºè®®å®šæœŸå¤‡ä»½é‡è¦æ•°æ®

## ğŸ¤ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ—¥å¿—æ–‡ä»¶ `etf_updater.log`
2. é…ç½®æ–‡ä»¶ `config.json`
3. ç½‘ç»œè¿æ¥å’Œç™¾åº¦ç½‘ç›˜æˆæƒçŠ¶æ€

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºä¸ªäººä½¿ç”¨ï¼Œè¯·éµå®ˆç›¸å…³æ•°æ®æä¾›æ–¹çš„ä½¿ç”¨æ¡æ¬¾ã€‚ 